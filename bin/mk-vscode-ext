#!/bin/sh

# Builds the VSCode language client extension and language server, and puts the language server
# binary near the built client.

set -eu

if [ "$#" -eq 0 ]; then
  echo "usage: $0 <path>..."
  exit 1
fi

cd "$(dirname "$0")"
cd ..

cargo build
mkdir -p extensions/vscode/out
cp target/debug/millet-ls extensions/vscode/out

cd extensions/vscode
npm run build
